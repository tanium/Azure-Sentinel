{
  "name": "DataBahnPushConnector",
  "apiVersion": "2024-01-01-preview",
  "type": "Microsoft.SecurityInsights/dataConnectors",
  "location": "{{location}}",
  "kind": "Push",
  "properties": {
    "connectorDefinitionName": "DataBahnPush",
    "dcrConfig": {
      "streamName": "Custom-databahn_audit_logs",
      "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
      "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
    },
    "auth": {
      "type": "Push",
      "appId": "{{appId}}",
      "servicePrincipalId": "{{servicePrincipalId}}"
    },
    "request": {
      "RetryCount": 1
    },
    "response": {
      "eventsJsonPaths": ["$.messages"]
    }
  }
}
